cinode:
  build: ./01-custom-jenkins
  ports:
   - "8080:8080"
  volumes:
   - /volumes/jenkins:/var/jenkins_home
   - /var/run/docker.sock:/var/run/docker.sock
  container_name: cinode
  privileged: true
  links:
  - qualitynode
  - binarynode

binarynode:
  image: "sonatype/nexus:2.11.2-06"
  ports:
   - "18081:8081"
#  volumes:
#   - /volumes/nexus/conf:/opt/sonatype/nexus/conf
#   - /volumes/nexus/work:/sonatype-work
  container_name: binarynode
 
qualitynode:
  image: "sonarqube:4.5.6"
  ports:
   - "9000:9000"
   - "9092:9092"
  container_name: qualitynode
  volumes:
   - /volumes/sonar/data:/opt/sonarqube/data
   - /volumes/sonar/ssl:/opt/sonarqube/ssl
   - /volumes/sonar/conf:/opt/sonarqube/conf
   - /volumes/sonar/extensions:/opt/sonarqube/extensions
  environment:
  - SONARQUBE_JDBC_URL=jdbc:mysql://sonardbnode:3306/sonar?useUnicode=true&characterEncoding=utf8&rewriteBatchedStatements=true&useConfigs=maxPerformance
  links:
  - sonardbnode

sonardbnode:
  image: "mysql:5.7"
  # PORT UNEXPOSED - ONLY AVAILABLE FOR CONTAINERS
  # ports: 
  # - "3306:3306"
  container_name: sonardbnode
  command: "--skip-grant-tables"
  volumes:
  - /volumes/sonar/mysql:/var/lib/mysql
